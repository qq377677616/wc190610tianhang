<template> 
  <div class="home container"> 
    <div ref="myHeader">
      <my-header :my-balance="myBalance | toFixeds" @jumpRecord="jumpRecord" @jumpRule="jumpRule"></my-header>
    </div>
    <div class="select-category">
      <div ref="selectTitle" :class="['h3', 'flex-cen', showType == 1 ? 'on' : '']"><div class="flex-cen" @click="choiceOfPlay">{{$t('lucky.home_title1')[curIndex_rule_toast]}}<img :src="ASSETSURL + '/lucky/images/icon_05.png'" alt="" /></div></div>
      <div ref="selectBox">
        <div class="select-category-box" v-show="showType == 1">
          <dl :class="['clearfix', langs == 'en' ? 'en' : '']">
            <dd v-for="(item, index) in $t('lucky.home_title1')" v-if="index != 0" :class="[index == curIndex_rule_toast ? 'cur' : '']" :data-id="index" @click="selectCategory">{{item}}</dd> 
          </dl> 
        </div>
        <div :class="['issue-number', langs == 'en' ? 'en' : '']" v-show="showType >= 2">
          <div class="issue-number-title flex-cen"><p>{{$t('lucky.home_title5[0]')}}</p><p>{{$t('lucky.home_title5[1]')}}</p><p>{{$t('lucky.home_title5[2]')}}</p><p>{{$t('lucky.home_title5[3]')}}</p><p>{{$t('lucky.home_title5[4]')}}</p></div>
          <div :class="['issue-number-box', showType == 3 ? 'max-height' : '']">
            <scroll class="scroll-box" ref="scrollIssueNumber">
              <ul>
                <li v-for="item in issueNumberList" :class="['flex-cen', item.status != 100 ? '' : 'wait-for']">
                  <p>{{item.displayNumber || 88888}}{{$t('lucky.home_title5[5]')}}</p>
                  <p>
                    <template v-if="item.status == 0">{{$t('lucky.home_title5[6]')}}</template>
                    <template v-if="item.status == 100">{{$t('lucky.home_title5[7]')}}</template>
                    <template v-if="item.status == 400">{{$t('lucky.home_title5[8]')}}</template>
                    <template v-if="item.status == 800">{{item.awardResult ? item.awardResult.join('') : '--'}}</template>
                    <template v-if="item.status == 900">{{$t('lucky.home_title5[9]')}}</template>
                    <template v-if="isNewUserGuide">88888</template>
                  </p>
                  <p>
                    <template v-if="item.tensType == 30">{{$t('lucky.home_title5[11]')}}</template>
                    <template v-if="item.tensType == 40">{{$t('lucky.home_title5[10]')}}</template>
                    <template v-if="item.tensType == 50">{{$t('lucky.home_title5[13]')}}</template>
                    <template v-if="item.tensType == 60">{{$t('lucky.home_title5[12]')}}</template>
                    <template v-if="isNewUserGuide">88888</template>
                  </p>
                  <p>
                    <template v-if="item.tensType == 30">{{$t('lucky.home_title5[11]')}}</template>
                    <template v-if="item.tensType == 40">{{$t('lucky.home_title5[10]')}}</template>
                    <template v-if="item.tensType == 50">{{$t('lucky.home_title5[13]')}}</template>
                    <template v-if="item.tensType == 60">{{$t('lucky.home_title5[12]')}}</template>
                    <template v-if="isNewUserGuide">88888</template>
                  </p>
                  <p>{{item.numberType ? (item.numberType == 10 ? $t('lucky.home_title5[14]') : $t('lucky.home_title5[15]')) : (isNewUserGuide ? '88888' : '')}}</p> 
                </li>
                <li class="toast">
                  <template v-if="issueNumberList.length > 0">
                    {{$t('lucky.home_title5[16]')}}{{issueNumberList.length}}{{$t('lucky.home_title5[17]')}}
                  </template> 
                  <template v-else>{{$t('lucky.home_title5[18]')}}</template>
                </li>
              </ul>
            </scroll> 
          </div>
        </div>
      </div>
    </div> 
    <div ref="ballSelection" :class="[!isDragIng ? 'transition' : '','', 'ball-selection', showType == 3 ? 'on' : '', calcTotalNotes > 0 ? 'isSatisfy' : '']" :style="{top: (isTakeBack ? initialBallSelection_top : ballSelection_top) + 'px'}" v-swipeup="swipeup" v-swipedown="swipedown" @touchstart="touchstart" @touchmove="touchmove" @touchend="touchend">
      <div class="timing" @click="openIssueNumber(false)">
        <div class="timing-con">
          <div class="flex-cen" v-show="!isInterval">
            <p>{{$t('lucky.home_title2[0]')}}{{currentIssueNumber}}{{$t('lucky.home_title2[1]')}}</p>
            <div class="timing-box"><timing ref="timing" @realTime="myRealTime" @timingEnd="myTimingEnd"></timing></div>
          </div>
          <p v-show="isInterval">{{!isStopping ? $t('lucky.home_title2[2]') : $t('lucky.home_title2[3]')}}</p>
        </div>
      </div>
      <div class="ball-selection-box">
        <scroll class="scroll-box" :data="selectIndexList" ref="scrollSelect" :pulldown="isPulldown" :listenScroll="isPulldown" @pulldown="pulldown" @scroll="listenScroll">
          <div>
            <h3>{{$t('lucky.home_title3')[curIndex_rule_toast]}}</h3>
            <img v-show="false" :src="ASSETSURL + '/lucky/images/icon_07s.png'" alt="" />
            <ul v-show="curIndex_rule_toast != 8">
              <li :class="[langs == 'en' ? 'en' : '']" v-for="(item, index) in selectIndexList" v-show="index >= showSelectNumber">
                <p :class="[langs == 'en' ? 'flex-cen' : '']"><span>{{(curIndex_rule_toast == 3 || curIndex_rule_toast == 4 || curIndex_rule_toast == 6) ? $t('lucky.home_title4') : (langs == 'zh-CHS' ? item.type : (langs == 'zh-CHT' ? item.type1 : item.type2))}}</span></p>
                <dl class="clearfix">
                  <dd v-for="(items, indexs) in 10" :class="[selectIndexList[index].selectNum.indexOf(indexs) != -1 ? 'cur animated bounceIn' : '']" :data-type="index" :data-index="indexs" @click="selectNumber">{{items - 1}}</dd>
                </dl>
              </li>
            </ul>
            <ul v-show="curIndex_rule_toast == 8" class="alternative">
              <li :class="[langs == 'en' ? 'en' : '']" v-for="(item, index) in selectIndexList" v-show="index >= showSelectNumber">
                <p :class="[langs == 'en' ? 'flex-cen' : '']"><span>{{langs == 'zh-CHS' ? item.type : (langs == 'zh-CHT' ? item.type1 : item.type2)}}</span></p>
                <dl class="clearfix">
                  <dd v-for="(items, indexs) in $t('lucky.home_title6')" :class="[selectIndexList[index].selectNum.indexOf(indexs) != -1 ? 'cur animated bounceIn' : '']" :data-type="index" :data-index="indexs" @click="selectNumber">{{items}}</dd>
                </dl>
              </li>
            </ul>
          </div>
        </scroll>
      </div>
    </div>
    <div class="betting-list" v-show="isShowBettingList" @click="bounceUpBetting">
      <div class="betting-list-box" v-show="isShowBettingList" @click.stop>
        <h3>{{$t('lucky.home_title8[0]')}}</h3>
        <div class="empty"><span @click="emptyBetting">{{$t('lucky.home_title8[1]')}}</span></div>
        <div :class="['scroll-betting-list', betting.length >= 4 ? 'on' : '']">
          <scroll :data="betting" class="scroll-betting-con" ref="scrollBetting">
            <ul>
              <li v-for="(item, index) in betting" v-show="item.selectNum.length != 0">
                <div class="delete" @click="delegateBettingItem(index)"></div>
                <div class="num"><div><p>{{$t('lucky.home_title1')[item.id]}}</p><template v-if="item.id == 8 && langs == 'en'"><br/></template><span v-for="items in item.selectNum">{{item.id != 8 ? items : switchNumber(items, langs)}}</span></div></div>
                <h4>{{$t('lucky.home_title8[2]')}}{{item.stage}}{{$t('lucky.home_title8[3]')}}<span>{{$t('lucky.home_title8[4]')}}{{item.notes}}{{$t('lucky.home_title8[5]')}}</span></h4>
                <div class="add-reduce flex-bet">
                  <div><h5>{{$t('lucky.home_title7[1]')}}</h5><span>{{rule_toast[item.id].base * item.times}}&nbsp;WLC</span></div>
                  <div class="add-reduce-box flex-cen">
                    <div :class="['btn', 'reduce', (isAddReduce == 1 && item.clickActivate) ? 'on' : '']" @click="addReduceNotes(index, '-')"></div>
                    <div class="number"><input type="number" pattern="\d*" v-model="item.times" @blur="backPageTop(index)" @input="input(index)" @focus="focus"/>ÂÄç</div>
                    <div :class="['btn', 'add', (isAddReduce == 2 && item.clickActivate) ? 'on' : '']" @click="addReduceNotes(index, '+')"></div>
                  </div>
                </div>
              </li>
            </ul>
          </scroll>
        </div>
      </div>
    </div>
    <div :class="['betting', calcTotalNotes > 0 ? 'on' : '', langs == 'en' ? 'en' : '']">
      <div class="betting-con flex-ali">
      <transition name="bottom-top">
        <div class="cur-betting" v-show="isSelectNumber && !isShowBettingList"><span v-for="(item, index) in selectIndexList" v-show="index >= showSelectNumber">{{item.selectNum.length != 0 ? (curIndex_rule_toast != 8 ? item.selectNum.join('') : switchNumber(item.selectNum.join(''), langs)) : '--'}}</span></div>
      </transition>
        <div class="betting-box flex-bet">
          <div class="left flex-ali" @click="bounceUpBetting">
            <span>{{calcTotalNotes}}{{$t('lucky.home_title7[0]')}}</span>
            <div>
              <h4>{{total_money}}WLC</h4>
              <p>{{$t('lucky.home_title7[1]')}}{{total_estimate}}WLC</p>
              <h5>{{$t('lucky.home_title7[3]')}}</h5>
            </div>
          </div>
          <div class="right" @click="confirmBet">{{$t('lucky.home_title7[2]')}}</div>
        </div>
      </div>
    </div>
    <div v-if="!isPageData" class="loading-pageData flex-cen">
      <loading is-full="1" is-icon="1" :title="loadingConductTitle"></loading>
    </div>
    <transition name="fadeInOut">
    <div v-if="isGuide && isNewUserGuide" :class="['guide', guideBackTransparent ? 'on' : '']">
      <div class="guide-box" :style="{top: guideBoxTop + 'px'}"><img :src="ASSETSURL + '/lucky/images/hand.png'" alt="" /></div>
    </div>
    </transition>
    <my-loading v-if="!isLoadingOk" ref="MyLoading" @loadingOk="loadingOk"></my-loading>
    <my-audio></my-audio>
    <!-- ÂàíËΩ¨ÂºπÊ°Ü -->
    <transfer ref="transferData" ></transfer>
  </div>
</template>
 
<script type="text/ecmascript-6">
import MyHeader from 'components/lucky/my-header/my-header'
import MyLoading from 'components/lucky/loading/loading'
import Timing from 'components/lucky/timing/timing'
import Loading from 'base/loading/loading'
import MyAudio from 'components/lottery/audio/audio'
import Scroll from 'base/scroll/scroll'
import { distanceFromCurrent, accMul, musicPlay, backPageTop, combination, stringToNumber, prefixStyle, minutesAndSeconds } from 'common/js/util'
import { ERR_Ok, TOAST } from 'api/config'
import { TweenMax, Power2, TimelineLite } from "gsap"
import { mapState, mapMutations } from 'vuex'
import { getUserInfo, getIsNewUser, getCurrentInstance, getRecentRecord, ssc_purchase } from "api/request"
import transfer from "@/components/common/transferDialog"
  export default {
    name: 'App',
    data() {
      return { 
        isLoadingOk: false,//Âä†ËΩΩloadingÈ°µ
        isNewUserGuide: false,//ÊòØÂê¶ÊòØÊñ∞Êâã
        isGuide: true,//Êñ∞ÊâãÊåáÂºïÊòæÁ§∫
        isCurrentPage: false,//ÊòØÂê¶Âú®ÂΩìÂâçÈ°µÈù¢
        isInterval: false,//ÊØèÊúü‰πãÈó¥Èó¥Èöî
        isStopping: false,//ÊòØÂê¶ÂÅúÊ≠¢ÈîÄÂîÆÔºàÊôö‰∏ä2Ôºö00Ëá≥Êó©‰∏ä9Ôºö50ÊöÇÂÅúÂºÄÊúüÔºâ
        pausePeriod: [2, 10],//Â§úÈó¥ÊöÇÂÅúÈîÄÂîÆÊó∂Èó¥ÊÆµ
        pollingTimes: 5000,//ÂΩìÂú®ÊØèÊúüÊó∂Èó¥Èó¥ÈöîËΩÆËØ¢Êó∂Èó¥
        isPageData: false,//È°µÈù¢Êï∞ÊçÆÊòØÂê¶ÂàùÂßãÂåñ
        loadingConductTitle: '',
        dragTop: 0,//ÂΩìÂâçÊªëÂä®‰∏ãÊãâË∑ùÁ¶ª
        isPulldown: true,//ÈÄâÁêÉÂå∫ÊòØÂê¶ÂèØ‰ª•‰∏ãÊãâ
        showType: 0,//ÊéßÂà∂ÊòæÁ§∫Áé©Ê≥ïÈÄâÊã©Âå∫ÂíåÂºÄÂ•ñÂéÜÂè≤Âå∫
        guideBoxTop: 200,
        guideBackTransparent: false,
        isDrag: false,//ÊòØÂê¶Âú®‰∏ãÊãâÊªëÂä®
        isDragIng: false,//ÊòØÂê¶Âú®ÂΩìÂâç‰∏ÄÊ¨°ÁöÑ‰∏ãÊãâÊªëÂä®
        allowDropDown: false,//Âêë‰∏äÊªëÂä®‰∏¥ÁïåÁÇπ
        screenYStart: 0,//ÂºÄÂßãËß¶Êë∏ÊªëÂä®YÂÄº
        screenYMove: 0,//Ëß¶Êë∏ÊªëÂä®‰∏≠YÂÄº
        screenYEnd: 0,//ÁªìÊùüËß¶Êë∏ÊªëÂä®YÂÄº
        once_modifyType: true,//ÊªëÂä®Êó∂Âè™ÂÖÅËÆ∏‰∏ÄÊ¨°ÂèòÂä®
        touchstartType: -1,//Ëß¶Êë∏Êó∂ÂΩìÂâçtypeÂÄº
        touchvalve: 20,//‰∏ãÊãâÊªëÂä®ÈòÄÂÄº
        myHeader_h: 40,//headerÂ§¥ÈÉ®È´òÂ∫¶
        selectTitle_h: 30,//ÈÄâÊã©Áé©Ê≥ïtitleÈ´òÂ∫¶
        selectBox_h: 0,//ÈÄâÊã©Áé©Ê≥ï„ÄÅÂºÄÂ•ñÂéÜÂè≤Âå∫ÂüüÊÄªÂå∫ÂüüÈ´òÂ∫¶
        isTakeBack: false,//ÊòØÂê¶‰∏∫Âú®ÊòæÁ§∫ÂºÄÂ•ñÂéÜÂè≤Êó∂Êî∂Ëµ∑ÈÄâÊã©Âè∑Á†ÅÂå∫ÔºàÂÖàÊî∂ÂÜçÈöêÊïàÊûúÔºâ
        currentIssueNumber: '----',//ÂΩìÂâçÊúüÂè∑
        isShowBettingList: false,//Â∑≤ÈÄâÊäïÊ≥®ÂàóË°® 
        recentRecordCount: 50,//ËøëÊúüÂºÄÂ•ñËÆ∞ÂΩïÊù°Êï∞
        issueNumberList: 50,//ËøëÊúüÂºÄÂ•ñËÆ∞ÂΩï
        isAddReduce: 0,//Âä†ÂáèÊåâÈíÆÊéßÂà∂Âô®
        notesRange: [1, 100],//‰∏ãÊ≥®ÂÄçÊï∞ËåÉÂõ¥
        rule_toast: [//ÊâÄÊúâÁé©Ê≥ï
                     { type:'‰∫îÊòüÈÄöÈÄâ', id: 0, base:100000, minSelectNum: 1, toast: 'ÊØè‰ΩçËá≥Â∞ëÈÄâ1‰∏™Âè∑ÔºåÊåâ‰ΩçÁåúÂØπÂºÄÂ•ñÂè∑ÊúÄÈ´òÂ•ñ20440WLC' },
                     { type:'‰∫îÊòüÁõ¥ÈÄâ', id: 1, base:100000, minSelectNum: 1,  toast: 'ÊØè‰ΩçËá≥Â∞ëÈÄâ1‰∏™Âè∑ÔºåÊåâ‰ΩçÁåúÂØπÂºÄÂ•ñÂè∑Âç≥‰∏≠100000WLC' },
                     { type:'‰∏âÊòüÁõ¥ÈÄâ', id: 2, base:1000, minSelectNum: 1,  toast: 'ÊØè‰ΩçËá≥Â∞ëÈÄâ1‰∏™Âè∑ÔºåÊåâ‰ΩçÁåúÂØπÂºÄÂ•ñÂêé3‰ΩçÂç≥‰∏≠1000WLC' },
                     { type:'‰∏âÊòüÁªÑ‰∏â', id: 3, base:320, minSelectNum: 2,  toast: 'Ëá≥Â∞ëÈÄâ2‰∏™Âè∑ÔºåÁåúÂØπÂºÄÂ•ñÂêé3‰ΩçÔºàÈ°∫Â∫è‰∏çÈôêÔºâ‰∏≠320WLC' },
                     { type:'‰∏âÊòüÁªÑÂÖ≠', id: 4, base:160, minSelectNum: 3,  toast: 'Ëá≥Â∞ëÈÄâ3‰∏™Âè∑ÔºåÁåúÂØπÂºÄÂ•ñÂêé3‰ΩçÔºàÈ°∫Â∫è‰∏çÈôêÔºâ‰∏≠160WLC' },
                     { type:'‰∫åÊòüÁõ¥ÈÄâ', id: 5, base:100, minSelectNum: 1,  toast: 'ÊØè‰ΩçËá≥Â∞ëÈÄâ1‰∏™Âè∑ÔºåÊåâ‰ΩçÁåúÂØπÂºÄÂ•ñÂêé2‰ΩçÂç≥‰∏≠100WLC' },
                     { type:'‰∫åÊòüÁªÑÈÄâ', id: 6, base:50, minSelectNum: 2,  toast: 'Ëá≥Â∞ëÈÄâ2‰∏™Âè∑ÔºåÁåúÂØπÂºÄÂ•ñÂêé2‰ΩçÔºàÈ°∫Â∫è‰∏çÈôêÔºâ‰∏≠50WLC' },
                     { type:'‰∏ÄÊòüÁõ¥ÈÄâ', id: 7, base:10, minSelectNum: 1,  toast: 'Ëá≥Â∞ëÈÄâ1‰∏™Âè∑ÔºåÁåúÂØπÂºÄÂ•ñÂè∑Á†ÅÊúÄÂêé1‰ΩçÂç≥‰∏≠10WLC' },
                     { type:'Â§ßÂ∞èÂçïÂèå', id: 8, base:4, minSelectNum: 1,  toast: 'ÊØè‰ΩçËá≥Â∞ëÈÄâ1‰∏™Âè∑ÔºåÁåúÂØπÂºÄÂ•ñÂêé2‰ΩçÁöÑÂ±ûÊÄßÂç≥‰∏≠4WLC', alternative: ['Â§ß', 'Â∞è', 'Âçï', 'Âèå'] },
                    ],            
        curIndex_rule_toast: 1,//ÂΩìÂâçÈÄâÂÆöÁé©Ê≥ïÁ¥¢Âºïid
        showSelectNumber: 0,//Áî®Êù•ÊéßÂà∂ÊòæÁ§∫‰∏áÂçÉÁôæÂçÅ‰∏™‰Ωç
        selectIndexList: [
                           { type: '‰∏á‰Ωç', type1: 'Ëê¨‰Ωç', type2: 'A', selectNum: [] },
                           { type: 'ÂçÉ‰Ωç', type1: 'ÂçÉ‰Ωç', type2: 'B', selectNum: [] },
                           { type: 'Áôæ‰Ωç', type1: 'Áôæ‰Ωç', type2: 'C', selectNum: [] },
                           { type: 'ÂçÅ‰Ωç', type1: 'ÂçÅ‰Ωç', type2: 'D', selectNum: [] },
                           { type: '‰∏™‰Ωç', type1: 'ÂÄã‰Ωç', type2: 'E', selectNum: [] }
                         ],
        betting: [//Â∑≤ÈÄâÊäïÊ≥®ÂàóË°®
                   // { type:'‰∫îÊòüÈÄöÈÄâ', selectNum: [], stage: '20181204069', notes: 0, income: 0, times: 1}
                 ],
        isCurrentNote: false,//Áî®Êù•Âà§Êñ≠Âú®ÊîπÂΩìÂâçÊ≥®         
        calcTotalNotes: 0,//ÊÄªÊ≥®Êï∞
        calcBettingNums: 0,//Â∑≤ÈÄâÊäïÊ≥®ÁßçÁ±ª
        total_estimate: 0,//ÊÄªÈ¢ÑËÆ°Êî∂ÂÖ•                                      
        total_money: 0,//ÊÄªÊäïÊ≥®ÈáëÈ¢ù 
        interval_updating: null,//Ëá™Âä®Âà∑Êñ∞ÂΩìÂâçÊúüÂÆöÊó∂Âô® 
        interval_residence_time: null,//ÂÆöÊó∂Âô®-ËÆ°Êó∂Áî®Êà∑Âú®È¶ñÈ°µÂÅúÁïô‰∫ÜÂ§ö‰πÖ
        residence_time: 0//Áî®Êà∑Âú®È¶ñÈ°µÂÅúÁïôÊó∂Èó¥                                     
      }    
    },
    beforeCreate() {
    },
    created() {  
    },
    activated() {
      this.addScript();//‰∏çË¶ÅÂéªÊéâËøôÊÆµ‰ª£Á†ÅÔºåÂê¶ÂàôÊ∏∏ÊàèÂàáÊç¢Êó∂È°µÈù¢‰ºöÈîô‰π±
      this.isCurrentPage = true
      this.interval_residence_time = setInterval(() => {
        this.residence_time++
      }, 1000) 
      //this.getIsNewUser()
      /*if (this.isNewUserGuide) {
        this.newUserGuide(() => {
          this.isNewUserGuide = false
          this.pageDataInit()
        })
      } else {
        this.pageDataInit()
      }*/
    },
    beforeMount() {

    },
    mounted() {
      this.addScript();//‰∏çË¶ÅÂéªÊéâËøôÊÆµ‰ª£Á†ÅÔºåÂê¶ÂàôÊ∏∏ÊàèÂàáÊç¢Êó∂È°µÈù¢‰ºöÈîô‰π±
      if (this.$refs.MyLoading) { 
        this.$refs.MyLoading.progressComplete()
      }
      this.getEleHeight()
      //this.$refs.scrollIssueNumber.refresh()
      //this.$refs.scrollSelect.refresh()
    },
    computed: {
      //Âà§Êñ≠ÊòØÂê¶ÈÄâ‰∫Ü‰∏Ä‰∏™Âè∑
      isSelectNumber() {
        for (let i = 0; i < this.selectIndexList.length; i++) {
          if (this.selectIndexList[i].selectNum.length != 0) {
            return true
          }
        }
        return false
      },
      //Âà§Êñ≠ÂΩìÂâçÈÄâÂè∑ÊòØÂê¶Êª°Ë∂≥‰∏ÄÊ≥®‰ª•‰∏äÈÄâÂè∑
      isSatisfy() {
        for (let i = this.showSelectNumber; i < this.selectIndexList.length; i++) {
          if (this.selectIndexList[i].selectNum.length < this.rule_toast[this.curIndex_rule_toast].minSelectNum) {
            return false
          }
        }
        return true
      },
      ballSelection_top() {
        return this.myHeader_h + this.selectTitle_h + this.selectBox_h + this.dragTop
      },
      initialBallSelection_top() {
        return this.myHeader_h + this.selectTitle_h + this.dragTop
      },
      currentTimePeriod() {
        let _date = new Date()
        return _date.getHours()
      },
      ...mapState({
        isLoading: 'isLoading',
        myBalance: 'myBalance',
        langs: 'langs',
        ASSETSURL: 'ASSETSURL'    
      })
    },
    methods: {
      addScript() {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "./static/js/lottery.js";
        document.body.appendChild(script);
      },
      //È°µÈù¢Êï∞ÊçÆÂàùÂßãÂåñ
      pageDataInit(isSilenceRefresh) {
        if (!isSilenceRefresh) this.isPageData = false
        this.getUserInfo()//Ëé∑ÂèñÁî®Êà∑‰∏™‰∫∫‰ø°ÊÅØ
        this.getCurrentInstance()//Ëé∑ÂèñÂΩìÂâçÊúü
        this.getRecentRecord()//Ëé∑ÂèñËøëÊúüÂºÄÂ•ñËÆ∞ÂΩï
      },
      //ÊòØÂê¶‰∏∫Êñ∞Áî®Êà∑ 
      getIsNewUser() {
        this.isPageData = true
        this.pageDataInit()
        return false
        getIsNewUser().then(res => {
          if (res.code === ERR_Ok) {
            if (res.data.sscBetCount == 0) {
              this.isNewUserGuide = true
            } else {
              this.isNewUserGuide = false
            }
            this.isPageData = true
            if (this.isNewUserGuide) {
              this.newUserGuide(() => {
                this.isNewUserGuide = false
                this.pageDataInit()
              })
            } else {
              this.pageDataInit()
            } 
          }
        }).catch(err => {
          //this.$toast(this.$t(res.code))
          this.isPageData = true
          console.log(err)
        })
      },
      //Áî®Êà∑‰∏™‰∫∫‰ø°ÊÅØ
      getUserInfo() {
        getUserInfo().then(res => {
          if (res.code === ERR_Ok) {
            this.updateBalance({myBalance: res.data.wlcBalance})
          }
        }).catch(err => {
          //this.$toast(this.$t(res.code))
          console.log(err)
        }) 
      },
      //Ëé∑ÂèñÂΩìÂâçÂΩ©Êúü
      getCurrentInstance(callback) {
        getCurrentInstance().then(res => {
          if (res.code === ERR_Ok) {
            setTimeout(() => { this.isPageData = true }, 500)
            if (res.data) {
              this.currentIssueNumber = res.data.displayNumber
              console.log(res.data.endTime )
              if (res.data.endTime > 0) {
                this.isInterval = false
                // this.$refs.timing.start(distanceFromCurrent(res.data.endTime))
                this.$refs.timing.start(res.data.endTime)
              } else {
                if (this.currentTimePeriod >= this.pausePeriod[0] && this.currentTimePeriod < this.pausePeriod[1]) {
                  this.isStopping = true
                } else {
                  this.isStopping = false
                }
                this.isInterval = true
                if (!this.isCurrentPage) return
                setTimeout(() => { this.getCurrentInstance() }, this.pollingTimes)
              }
              if (callback) callback()
            } else {
              this.isInterval = true
            }
          }
        }).catch(err => {
          //this.$toast(this.$t(res.code))
          this.isPageData = true
          console.log(err)
        })
      },
      //Ëé∑ÂèñËøëÊúüÂºÄÂ•ñËÆ∞ÂΩï
      getRecentRecord() {
        getRecentRecord(this.recentRecordCount).then(res => {
          if (res.code === ERR_Ok) {
            this.issueNumberList = res.data
          }
        }).catch(err => {
          //this.$toast(this.$t(res.code))
        }) 
      },
      handleTransfer(){
        this.$refs.transferData.showMask = true
        this.$refs.transferData.showDialog = true
      },
      //Á°ÆËÆ§ÊäïÊ≥®
      confirmBet() {
        if (this.betting.length == 0) return false
        if (this.total_money > 200) {
          this.$toast(this.$t('lucky.toasts[8]'))
          return false
        }
        if (this.total_money > this.myBalance) {
          this.$toast(this.$t('lucky.toasts[3]'))
          this.handleTransfer()//‰ΩôÈ¢ù‰∏çË∂≥Êó∂ÂºπÊ°Ü
          return false
        }
        console.log(this.betting)
        this.isPageData = false
        this.loadingConductTitle = this.$t('lucky.toasts[0]')
        let _data = []
        for (let i = 0; i < this.betting.length; i++) {
          let _item = this.betting[i]
          let _obj = {
            multiple: _item.times
          }
          //100-‰∫îÊòüÁõ¥ÈÄâÔºå200-‰∏âÊòüÁõ¥ÈÄâÔºå300-‰∏âÊòüÁªÑÂÖ≠Ôºå310-‰∏âÊòüÁªÑ‰∏âÔºå400-‰∫åÊòüÁõ¥ÈÄâÔºå500-‰∫åÊòüÁªÑÈÄâÔºå600-‰∏ÄÊòüÁõ¥ÈÄâÔºå700-Â§ßÂ∞èÂçïÂèå
          if (_item.id == 1) {
            _obj.betRule = 100
          } else if (_item.id == 2) {
            _obj.betRule = 200
          } else if (_item.id == 3) {
            _obj.betRule = 310
          } else if (_item.id == 4) {
            _obj.betRule = 300
          } else if (_item.id == 5) {
            _obj.betRule = 400
          } else if (_item.id == 6) {
            _obj.betRule = 500
          } else if (_item.id == 7) {
            _obj.betRule = 600
          } else if (_item.id == 8) {
            _obj.betRule = 700
          }
          if (_item.id == 1 || _item.id == 2 || _item.id == 5 || _item.id == 7) {
            let _items = ['g', 's', 'b', 'q', 'w']
            let _selectNum = _item.selectNum.reverse()
            for (let i = 0; i < _selectNum.length; i++) {
              //_obj[_items[i]] = JSON.stringify(stringToNumber(_selectNum[i].split('')))
              _obj[_items[i]] = stringToNumber(_selectNum[i].split(''))
            }
          } else if (_item.id == 3 || _item.id == 4 || _item.id == 6) {
            //_obj.groupNumbers = JSON.stringify(stringToNumber(_item.selectNum[0].split(''))
            _obj.groupNumbers = stringToNumber(_item.selectNum[0].split(''))
          } if (_item.id == 8) {
            _obj.tensPlaceOption = stringToNumber(_item.selectNum[0].split('')),
            _obj.unitOption = stringToNumber(_item.selectNum[1].split(''))
          }
          _data.push(_obj)
        }
        console.log(_data)
        ssc_purchase(_data).then(res => {
          if (res.code === ERR_Ok) {
            if (res.data.respCode == 200) {
              setTimeout(() => {
                this.isPageData = true
                this.getUserInfo()
                this.emptyList()
                this.$toast(this.$t('lucky.toasts[1]'))
              }, 500) 
            } else if (res.data.respCode == 300) {
              this.isPageData = true
              this.$toast(this.$t('lucky.toasts[2]'))
            } else if (res.data.respCode == 400) {
              this.isPageData = true
              this.$toast(this.$t('lucky.toasts[3]'))
            }
          } else {
            setTimeout(() => {
              this.isPageData = true
              this.$toast(this.$t(res.code))
            }, 500)
          }
        }).catch(err => {
          //this.$toast(this.$t(res.code))
          this.isPageData = true
          console.log(err)
        }) 
      },
      //ÁÇπÂáªÊØè‰∏™ÁêÉËøõË°åÈÄâÂè∑
      selectNumber(e) {
        let _type = parseInt(e.target.dataset.type)
        let _index = parseInt(e.target.dataset.index)
        let _selectIndex = this.selectIndexList[_type].selectNum.indexOf(_index)
        this.buriedPoint()
        if (_selectIndex == -1) {
          this.selectIndexList[_type].selectNum.push(_index)
        } else {
          this.selectIndexList[_type].selectNum.splice(_selectIndex, 1)
        }
        this.selectIndexListSort()
        if (this.isSatisfy) {
          let _selectNum = []
          for (let i = 0; i < this.selectIndexList.length; i++) {
            if (this.selectIndexList[i].selectNum.length == 0) continue
            _selectNum.push(this.selectIndexList[i].selectNum.join(''))
          }
          let _group = {
            type: this.rule_toast[this.curIndex_rule_toast].type,
            id: this.rule_toast[this.curIndex_rule_toast].id,
            selectNum: _selectNum,
            stage: this.currentIssueNumber,
            times: 1
          }
          if (!this.isCurrentNote) {
            //Ê≠£Â∫èthis.betting.push(_group)
            this.betting.unshift(_group)
            this.isCurrentNote = true
          } else {
            //Ê≠£Â∫èthis.betting.splice(this.betting.length - 1, 1, _group)
            this.betting.splice(0, 1, _group)
          }
        } else {
          if (!this.isCurrentNote) return
          //Ê≠£Â∫èthis.betting.splice(this.betting.length - 1, 1)
          this.betting.splice(0, 1)
          this.isCurrentNote = false
          //this.betting[this.curIndex_rule_toast] = { type: this.rule_toast[this.curIndex_rule_toast].type, selectNum: [] }
        }
        this.calcTotalNote()
      },
      //‰∏çÂêåÁé©Ê≥ïÈÄâÂè∑ÂüãÁÇπ
      buriedPoint() {
        let _playId = this.curIndex_rule_toast  
        if (_playId == 1) {//‰∫îÊòüÁõ¥ÈÄâ
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-‰∫îÊòüÁõ¥ÈÄâ_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®‰∫îÊòüÁõ¥ÈÄâÁé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        } else if (_playId == 2) {//‰∏âÊòüÁõ¥ÈÄâ
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-‰∏âÊòüÁõ¥ÈÄâ_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®‰∏âÊòüÁõ¥ÈÄâÁé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        } else if (_playId == 3) {//‰∏âÊòüÁªÑ‰∏â
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-‰∏âÊòüÁªÑ‰∏â_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®‰∏âÊòüÁªÑ‰∏âÁé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        } else if (_playId == 4) {//‰∏âÊòüÁªÑÂÖ≠
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-‰∏âÊòüÁªÑÂÖ≠_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®‰∏âÊòüÁªÑÂÖ≠Áé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        } else if (_playId == 5) {//‰∫åÊòüÁõ¥ÈÄâ
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-‰∫åÊòüÁõ¥ÈÄâ_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®‰∫åÊòüÁõ¥ÈÄâÁé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        } else if (_playId == 6) {//‰∫åÊòüÁªÑÈÄâ
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-‰∫åÊòüÁªÑÈÄâ_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®‰∫åÊòüÁªÑÈÄâÁé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        } else if (_playId == 7) {//‰∏ÄÊòüÁõ¥ÈÄâ
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-‰∏ÄÊòüÁõ¥ÈÄâ_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®‰∏ÄÊòüÁõ¥ÈÄâÁé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        } else if (_playId == 8) {//Â§ßÂ∞èÂçïÂèå
          this.$buryPoint("clickSelectionNumber", "Êó∂Êó∂ÂΩ©-Â§ßÂ∞èÂçïÂèå_ÈÄâÂè∑", "Êó∂Êó∂ÂΩ©Âú®Â§ßÂ∞èÂçïÂèåÁé©Ê≥ï‰∏ãÁÇπÂáªÂè∑Á†ÅÁêÉËøõË°åÈÄâÂè∑")
        }
      },
      //ËÆ°ÁÆóÂçïÈ°πÊ≥®Êï∞„ÄÅÊÄªÊ≥®Êï∞
      calcTotalNote() {
        let _total = 0
        for (var i = 0; i < this.betting.length; i++) {
          let _typeId = this.betting[i].id
          //if (this.betting[i].selectNum.length == 0) continue
          let _num = 1
          if (_typeId <= 2 || _typeId == 5 || _typeId == 7 || _typeId == 8) {
            for (let j = 0; j < this.betting[i].selectNum.length; j++) {
              _num *= this.betting[i].selectNum[j].length
            }  
          } else if (_typeId == 3 || _typeId == 6) {
            _num = parseInt(this.betting[i].selectNum[0].length) * (parseInt(this.betting[i].selectNum[0].length) - 1)
          } else if (_typeId == 4) {
            _num = combination(parseInt(this.betting[i].selectNum[0].length), 3)
          } 
          this.betting[i].notes = _num
          _total += _num   
        }
        this.calcTotalNotes = _total
        //this.calcBettingNum()
      },
      //ËÆ°ÁÆóÊÄªÈ¢ÑËÆ°Êî∂ÂÖ•„ÄÅÊÄªÊäïÊ≥®ÈáëÈ¢ù
      calcTotalEstimate() {
        let _total_estimate = 0
        let _total_money = 0
        for (var i = 0; i < this.betting.length; i++) {
          _total_estimate += this.rule_toast[this.betting[i].id].base * this.betting[i].times
          _total_money += this.betting[i].notes * this.betting[i].times * 2
        }
        this.total_estimate = _total_estimate
        this.total_money = _total_money
      },
      //ÈÄâÊã©Áé©Ê≥ï
      selectCategory(e) {
        this.curIndex_rule_toast = e.target.dataset.id
        this.swipeup()
        this.isCurrentNote = false
        this.$buryPoint("clickSelect", "Êó∂Êó∂ÂΩ©-ÈÄâÊã©Áé©Ê≥ï", "Êó∂Êó∂ÂΩ©ÁÇπÂáªÊüêÁßçÁé©Ê≥ïÊåâÈíÆËøõË°åÂΩìÂâçÁé©Ê≥ïÈÄâÊã©")
      },
      //Ê∏ÖÁ©∫ÂΩìÂâçÈÄâÂè∑
      emptySelectNumber() {
        this.selectIndexList.forEach((item) => {
          item.selectNum = []
        })
      },
      //Âà†Èô§Â∑≤ÈÄâÊäïÊ≥®ÂàóË°®ÊüêÈ°π
      delegateBettingItem(index) {
        // this.$messagebox.confirm('', {title: this.$t('lucky.messagebox[4]'), message: this.$t('lucky.messagebox[5]'), cancelButtonText: this.$t('lucky.messagebox[2]'), confirmButtonText: this.$t('lucky.messagebox[3]')}).then(action => {
        //   if (index == 0 && this.isCurrentNote) {
        //     this.emptySelectNumber()
        //     this.isCurrentNote = false
        //   }
        //   this.betting.splice(index, 1)
        //   this.calcTotalNote()
        //   this.calcTotalEstimate()
        //   this.$toast(this.$t('lucky.toasts[4]'))
        // }, () => {})  
        if (index == 0 && this.isCurrentNote) {
          this.emptySelectNumber()
          this.isCurrentNote = false
        }
        this.betting.splice(index, 1)
        this.calcTotalNote()
        this.calcTotalEstimate()
        this.$toast(this.$t('lucky.toasts[4]'))
      },
      //Ê∏ÖÁ©∫ÊâÄÊúâÂ∑≤ÈÄâÊäïÊ≥®ÂàóË°®
      emptyBetting() {
        this.$messagebox.confirm('', {title: this.$t('lucky.messagebox[0]'), message: this.$t('lucky.messagebox[1]'), cancelButtonText: this.$t('lucky.messagebox[2]'), confirmButtonText: this.$t('lucky.messagebox[3]')}).then(action => {
          this.emptyList()
          this.$toast(this.$t('lucky.toasts[5]'))
        }, () => {})
      },
      emptyList() {
        this.betting = []
        this.calcTotalNote()
        this.calcTotalEstimate()
        this.emptySelectNumber()
      },
      //Â∞ÜÊâÄÊúâÈÄâÂè∑ÊéíÂ∫è
      selectIndexListSort() {
        for (let i = 0; i < this.selectIndexList.length; i++) {
          this.selectIndexList[i].selectNum.sort()
        }
      },
      //Ëé∑ÂèñdomÈ´òÂ∫¶
      getEleHeight() {
        this.myHeader_h = this.$refs.myHeader.offsetHeight
        this.selectTitle_h = this.$refs.selectTitle.offsetHeight
      },
      //ËÆ°ÁÆóÈ´òÂ∫¶
      dynamicCalcEleHeight() {
        this.$nextTick(() => {
          this.selectBox_h = this.$refs.selectBox.offsetHeight
        })
      },
      //‰∏ãÊãâ‰∫ã‰ª∂
      pulldown() {
        //this.openIssueNumber(true)
      },
      //ÁõëÂê¨ÊªöÂä®‰∫ã‰ª∂
      listenScroll(e) {
        if (e.y >= 0) {
          this.allowDropDown = true
        } else {
          this.allowDropDown = false
        }
      },
      //ÁõëÂê¨Ëß¶Êë∏ÊªëÂä®ÂºÄÂßã‰∫ã‰ª∂
      touchstart(e) {
        this.screenYStart = e.changedTouches[0].screenY
        this.isDragIng = true
        this.touchstartType =  this.showType
      },
      //ÁõëÂê¨Ëß¶Êë∏ÊªëÂä®‰∏≠‰∫ã‰ª∂
      touchmove(e) {
        this.screenYMove = e.changedTouches[0].screenY
        if (this.curIndex_rule_toast < 2 && !this.allowDropDown) return
        if (this.once_modifyType) {
          this.screenYEnd = e.changedTouches[0].screenY
          this.once_modifyType = false
        }
        if (this.showType < 2) this.showType = 2
        let _calcY = this.screenYMove - this.screenYStart - this.touchvalve
        if (this.curIndex_rule_toast <= 1) {
          _calcY -= (this.screenYEnd - this.screenYStart)
        }
        if(_calcY > 0) {
          this.isTakeBack = false
          if (this.touchstartType == 3) return false
          if (this.touchstartType == 0) {
            if (this.dragTop > 158) this.showType = 3
            _calcY > 273 ? this.dragTop = 273 : this.dragTop = _calcY
          } else if (this.touchstartType == 1) {
            _calcY > (158 - 124) ? this.showType = 3 : this.showType = 2
            _calcY > (273 - 124) ? this.dragTop = (273 - 124) : this.dragTop = _calcY
          } else if (this.touchstartType == 2) {
            this.showType = 3
            _calcY > (273 - 158) ? this.dragTop = (273 - 158) : this.dragTop = _calcY
          }
        }

      },
      //ÁõëÂê¨Ëß¶Êë∏ÊªëÂä®ÁªìÊùü
      touchend(e) {
        if (this.isDragIng) {
          this.isDragIng = false
          this.allowDropDown = false
          this.once_modifyType = true
          this.screenYStart = this.screenYMove = this.screenYEnd = this.dragTop = 0
          this.dynamicCalcEleHeight()
          this.$refs.scrollIssueNumber.refresh()
        }
      },
      //Ëá™ÂÆö‰πâ‰∫ã‰ª∂--‰∏ãÊãâ‰∫ã‰ª∂--‰∏ãÊãâÈÄâÂè∑Âå∫
      swipedown(e) {
        //this.openIssueNumber(true)
      },
      //Ëá™ÂÆö‰πâ‰∫ã‰ª∂--‰∏äÊãâ‰∫ã‰ª∂-->‰∏äÊãâÈÄâÂè∑Âå∫
      swipeup() {
        if (this.showType == 0) return false
        if (this.isDrag) {
          this.dragTop = 0
          return false
        }
        this.isTakeBack = true
        //this.$refs.scrollSelect.refresh()
        setTimeout(() => {
          this.showType = 0
          this.isTakeBack = false
          this.dynamicCalcEleHeight()
          this.$refs.scrollSelect.refresh()
        }, 550)
      },
      //ÂºπËµ∑Â∑≤‰∏ãÊ≥®ÂàóË°®
      bounceUpBetting() {
        this.isShowBettingList = !this.isShowBettingList
        setTimeout(() => {
          this.$refs.scrollBetting.refresh()
        }, 500)
      },
      //Âä†ÂáèÊ≥®Êï∞
      addReduceNotes(index, type) {
        if (type == '-') {
          this.betting[index].times > 1 ? (this.takeInverse('isAddReduce', 1), this.betting[index].clickActivate = true, setTimeout(() => { this.betting[index].clickActivate = false }, 500), this.betting[index].times--) : (this.betting[index].times == this.notesRange[0], this.$toast(`${this.$t('lucky.toasts[6]')}${this.notesRange[0]}`))
        } else if (type == '+') {
          this.betting[index].times < 100 ? (this.takeInverse('isAddReduce', 2), this.betting[index].clickActivate = true, setTimeout(() => { this.betting[index].clickActivate = false }, 500), this.betting[index].times++) : (this.betting[index].times == this.notesRange[1], this.$toast(`${this.$t('lucky.toasts[7]')}${this.notesRange[1]}`))
        }
        this.calcTotalEstimate()
      },
      //Â±ïÂºÄÈÄâÂè∑Âå∫
      openIssueNumber(isTouch) {
        if (this.showType < 2) {
          this.showType = 2
          this.isTakeBack = false
          this.dynamicCalcEleHeight()
        } else if (this.showType == 2) {
          this.showType = 3
          this.isTakeBack = false
          this.dynamicCalcEleHeight()
        } else if (this.showType == 3 && !isTouch) {
          this.isTakeBack = true
          setTimeout(() => {
            this.isTakeBack = false
            this.showType = 0
            this.dynamicCalcEleHeight()
          }, 550)
        }
        setTimeout(() => {
          this.$refs.scrollIssueNumber.refresh()
        }, 50)
        this.$buryPoint("clickOpen", "Êó∂Êó∂ÂΩ©-ÁÇπÂáªËøëÊúüÂºÄÂ•ñËÆ∞ÂΩïÊåâÈíÆ", "Êó∂Êó∂ÂΩ©ÁÇπÂáªÂÄíËÆ°Êó∂‰∏ÄÊ†èÂ±ïÂºÄËøëÊúüÂºÄÂ•ñËÆ∞ÂΩïÂå∫Âüü")
      },
      //Â±ïÂºÄÈÄâÊã©Áé©Ê≥ïÂå∫
      choiceOfPlay() {
        this.isTakeBack = false
        this.showType != 1 ? this.showType = 1 : (this.isTakeBack = true, setTimeout(() => { this.showType = 0 }, 550))
        this.dynamicCalcEleHeight()
        this.$buryPoint("clickOpen", "Êó∂Êó∂ÂΩ©-ÁÇπÂáªÁé©Ê≥ïÈÄâÊã©ÊåâÈíÆ", "Êó∂Êó∂ÂΩ©ÁÇπÂáªÂΩìÂâçÁé©Ê≥ïtitleÂ±ïÂºÄÊâÄÊúâÁé©Ê≥ïÂàóË°®Âå∫Âüü")
      },
      //ËæìÂÖ•Ê°ÜËÅöÁÑ¶
      focus() {
        this.$buryPoint("inputFocus", "Êó∂Êó∂ÂΩ©-ËæìÂÖ•Ê°Ü", "Êó∂Êó∂ÂΩ©ÁÇπÂáªinputËæìÂÖ•Ê°ÜËøõË°åÂÄçÊï∞ËæìÂÖ•")
      },
      //ËæìÂÖ•Ê°ÜËæìÂÖ•Â§ÑÁêÜ
      input(index) {
        let _votes = this.betting[index].times
        if (_votes >= this.notesRange[1]) {
          this.betting[index].times = this.notesRange[1]
          this.$toast(`${this.$t('lucky.toasts[7]')}${this.notesRange[1]}`)  
        }
      },
      //ËæìÂÖ•Ê°ÜÂ§±ÁÑ¶È°µÈù¢ÂõûÂà∞È°∂ÈÉ®
      backPageTop(index) {
        let _votes = this.betting[index].times
        if (!_votes || _votes < this.notesRange[0]) {
          this.$toast(`${this.$t('lucky.toasts[6]')}${this.notesRange[0]}`)
          this.betting[index].times = this.notesRange[0]
        }
        backPageTop()
      },
      //Êï∞Â≠óËΩ¨Êç¢ÊàêÂçïÂèå
      switchNumber(val, langs) {
        let _str = ''
        for (let i = 0; i < val.length; i++) {
          _str += this.$t('lucky.home_title6')[parseInt(val[i])]
          if (langs == 'en') _str += '-'
        }
        if (langs == 'en') {
          return _str.slice(0, _str.length - 1)  
        } else {
          return _str
        } 
      },
      //ÂèñÂèç
      takeInverse(variable, newValue){
        let _original = this[variable]
        this[variable] = newValue || true
        setTimeout(() => {
          newValue ? this[variable] = _original : this[variable] = false
        }, 50)
      },
      //Êñ∞Áî®Êà∑ÊåáÂºïÊïàÊûú
      newUserGuide(callback) {
        setTimeout(() => {
          this.guideBackTransparent = true
        }, 500)
        setTimeout(() => {
          this.showType = 2
          this.guideBoxTop = 285
          this.dragTop = 85
        }, 1500)
        setTimeout(() => {
          this.guideBoxTop = 200
          this.dragTop = 0
        }, 3000)
        setTimeout(() => {
          this.showType = 2
          this.guideBoxTop = 285
          this.dragTop = 85
        }, 4500)
        setTimeout(() => {
          this.guideBoxTop = 200
          this.dragTop = 0
        }, 6000)
        setTimeout(() => {       
          this.isGuide = false
          this.showType = 0
          setTimeout(() => { if (callback) callback() }, 1500)         
        }, 6500)
      },
      //Ë∑ØÁî±Ë∑≥ËΩ¨
      jumpRecord(isLottery) {
        if (isLottery) {
          this.isShowModal = false
          this.$router.push({ name: 'lotteryHistory', params: { isLottery: true } })
        } else {
          this.$buryPoint("clickToview", "Êó∂Êó∂ÂΩ©-ÊäïÊ≥®ËÆ∞ÂΩï", "Êó∂Êó∂ÂΩ©ÁÇπÂáªÂ§¥ÈÉ®ÊåâÈíÆËøõÂÖ•ÊäïÊ≥®ËÆ∞ÂΩïÈ°µÈù¢")
          this.$router.push("../lucky/record")
        }
      }, 
      myRealTime() {

      },
      myTimingEnd() {
       console.log('Êú¨ÊúüÊó∂Èó¥Âà∞')
       this.pageDataInit(true)
       setTimeout(() => {
         this.getCurrentInstance()
         // this.getCurrentInstance(() => {
         //   this.$toast(`Êú¨ÊúüÂ∑≤ÂàáÊç¢ÔºåÂΩìÂâçÊòØ${this.currentIssueNumber}Êúü`)
         // })
       }, 1000)
      },
      //È°µÈù¢loadingÈ°µÂä†ËΩΩÂõûË∞É
      loadingOk() {
        setTimeout(() => {
          this.getIsNewUser()
          this.isLoadingOk = true 
          this.updateIsLoading(true)
          if (!this.isMusicMuted) musicPlay("music-back")
        }, 800)
      },
      jumpRule() {
        this.$buryPoint("clickToview", "Êó∂Êó∂ÂΩ©-Áé©Ê≥ïËßÑÂàô", "Êó∂Êó∂ÂΩ©ÁÇπÂáªÂ§¥ÈÉ®ÊåâÈíÆËøõÂÖ•Áé©Ê≥ïËßÑÂàôÈ°µÈù¢")
        this.$router.push("../lucky/rule") 
      }, 
      ...mapMutations({
        updateIsLoading: 'updateIsLoading',
        updateBalance: 'updateBalance'
      })    
    },
    filters: {
      //Âêë‰∏ã‰øùÁïô‰∏§‰ΩçÂ∞èÊï∞
      toFixeds(val) {
        let _num = String(val)
        let _index = _num.indexOf('.')
        if (_index == - 1) { return _num + '.00' }
        if (_num.length - _index == 2) {
          return _num + '0'
        } else if (_num.length - _index == 3) {
          return _num
        } else  if (_num.length - _index > 3) {
          return _num.slice(0, _index + 3)
        }
      },
      digitSwitch(val) {
        console.log(val)
        // if (val == 30) return 'Â§ßÂçï'
        // if (val == 40) return 'Â§ßÂèå'
        // if (val == 50) return 'Â∞èÂçï'
        // if (val == 60) return 'Â∞èÂèå'
      } 
    },
    watch: {
      //ÁõëÂê¨Áé©Ê≥ïÈÄâÊã©
      curIndex_rule_toast(newValue) {
        let _newValue = parseInt(newValue)
        switch (_newValue){
          //case 0://‰∫îÊòüÈÄöÈÄâ
          //this.showSelectNumber = 0
          case 1://‰∫îÊòüÁõ¥ÈÄâ
          this.showSelectNumber = 0
          break
          case 2://‰∏âÊòüÁõ¥ÈÄâ
          this.showSelectNumber = 2
          break
          case 3://‰∏âÊòüÁªÑÈÄâ
          this.showSelectNumber = 4
          break
          case 4://‰∏âÊòüÁªÑÂÖ≠
          this.showSelectNumber = 4
          break
          case 5://‰∫åÊòüÁõ¥ÈÄâ
          this.showSelectNumber = 3
          break
          case 6://‰∫åÊòüÁªÑÈÄâ
          this.showSelectNumber = 4
          break
          case 7://‰∏ÄÊòüÁõ¥ÈÄâ
          this.showSelectNumber = 4
          break          
          case 8://Â§ßÂ∞èÂçïÂèå
          this.showSelectNumber = 3
          break
        }
        this.emptySelectNumber()
      },
      //ÁõëÂê¨ÊÄªÊ≥®Êï∞ÂèòÂåñ
      calcTotalNotes() {
        this.calcTotalEstimate()
      },
      //ÁõëÂê¨Â∑≤ÈÄâÊäïÊ≥®ÂàóË°®
      betting: {
        handler (newValue, oldValue) {
          //console.log(newValue)
          //console.log(oldValue)
          if (newValue.length == 0) {
            this.isShowBettingList = false
          }
        },
        deep: true
      }
    },
    components: { 
      MyHeader,
      MyLoading,
      MyAudio,
      Scroll,
      Timing,
      Loading,
      transfer
    },
    beforeDestroy() {

    },
    destroyed() {

    },
    deactivated() {
      clearInterval(this.interval_residence_time)
      this.$buryPoint("residenceTime", "Êó∂Êó∂ÂΩ©--È¶ñÈ°µÂÅúÁïôÊó∂Èó¥", `Áî®Êà∑Âú®Êó∂Êó∂ÂΩ©È¶ñÈ°µÂÅúÁïô‰∫Ü${minutesAndSeconds(this.residence_time)}`)
      this.residence_time = 0
      this.isCurrentPage = false
      if (this.interval_updating) clearTimeout(this.interval_updating)
    }
  } 
</script>

<style scoped lang="stylus" rel="stylesheet/stylus">
@import '~common/style/mixin'
@import '~common/style/variable'
  .container
    background: linear-gradient(180deg,rgba(22,107,206,1) 0%,rgba(1,132,208,1) 100%)
    color: #fff 
    font-size: 0
    min-height: 100vh
    text-align: left
    .guide
      fixed-full(1000)
      //transition-delay: .5s !important
      transition: all 1s
      background: rgba(0,0,0,.6)
      .guide-box
        width: 1.03rem
        position: absolute
        left: calc(50% + .15rem)
        //top: 50%
        transform: translateX(-50%)
        transition: all .5s
        img
          width: 100%
          margin-left: 1rem
          transition: all .5s
      &.on
        background: rgba(0,0,0,.2)
        img
          margin-left: 0      
    .loading-pageData
      absolute-full(500)  
    .select-category
      .h3
        height: h =.24rem
        line-height: h
        text-align: center
        font-size: .17rem
        font-family: PingFangSC
        font-weight: 600
        color: #fff
        text-shadow:0px 1px 1px rgba(38,117,209,1)
        padding-bottom: .06rem
        &.on img
          transform: rotate(180deg)
        img
          width: .2rem
          height: .24rem
          transform-origin: center
          transition: all .5s
      .select-category-box
        padding: .05rem .17rem
        text-align: center
        dl 
          dd   
            float: left
            width: 30%
            margin: .05rem 0
            height: h = .28rem    
            line-height: h 
            back-image($ASSETSURL + '/lucky/images/btn_01.png')
            font-size: .13rem
            font-weight: bold
            color: rgba(0,121,226,1)
            background-size: 100% 100%
            &:nth-child(3n - 1)
              margin: .05rem 5%
            &.cur
              background-image: url($ASSETSURL + '/lucky/images/btn_01s.png')
          &.en dd
            font-size: .12rem
            word-break: break-word
            line-height: .12rem 
            padding: .02rem 0
            box-sizing: border-box   
      .issue-number
        padding: .1rem .22rem .13rem .16rem
        background: #1288DA url($ASSETSURL + '/lucky/images/bg_01.png') no-repeat center top
        background-size: 100%
        margin-top: .05rem
        text-align: left
        &.en p:nth-child(2)
            width: 18%
          &.en p:nth-child(5)
            width: 24% 
        .issue-number-box
          height: 1.09rem
          //height: 2.24rem
          .scroll-box
            height: 100%
            overflow: hidden
          &.max-height
            height: 2.24rem  
        .issue-number-title
          height: h =.18rem
          line-height: h
          font-size: .13rem
          font-family: PingFangSC
          font-weight: bold;
          color: rgba(207,231,247,1)
          margin-bottom: .08rem
          white-space: nowrap
        p:first-child
          width: 22% 
        p:nth-child(2)
          width: 30%
        p:nth-child(3)
          width: 8%
        p:nth-child(4)
          width: 8%
          margin: 0 12%
        p:nth-child(5)
          width: 8% 
        ul li
          height: h = .17rem
          line-height: h
          color: rgba(137,195,236,1)
          font-size: .12rem
          white-space: nowrap
          &.toast
            padding: .15rem 0
            text-align: center
            color: #fff
          p:nth-child(2)~p
            color: rgba(207,231,247,1)                
          &:not(:last-child)
            margin-bottom: .06rem
          &.wait-for p:nth-child(2)
            color:rgba(255,186,106,1)
    .ball-selection
      position: fixed
      width: 100%
      left: 0
      //top: .7rem
      bottom: 0
      z-index: 200
      &.transition
        transition: top .5s
      &.isSatisfy
        bottom: .56rem
      .timing
        height: h = .3rem
        position: relative
        back-image($ASSETSURL + '/lucky/images/bg_03.png')
        z-index: 100
        p
          font-size: .11rem
          font-family: PingFangSC
          color: rgba(160,207,240,1)
          text-align: center
          height: _h = .23rem
          line-height: _h
          position: relative
          z-index: 5
        .timing-box
          position: relative
          z-index: 10  
          padding-left: .05rem
        &::before
          content: ''
          display: block
          width: 100%
          height: .23rem  
          background:linear-gradient(180deg,rgba(38,160,239,1) 0%,rgba(14,134,217,1) 10%,rgba(26,140,222,1) 86%,rgba(21,137,220,1) 100%)
          position: absolute
          left: 0
          top: 0
          z-index: 1
        &::after
          content: ''
          display: block
          width: .46rem
          height: .08rem
          back-image($ASSETSURL + '/lucky/images/icon_06.png')
          background-size: .16rem
          background-position: center top
          position: absolute
          left: calc(50% - .23rem)
          bottom: 0
          transform-origin: center
          z-index: 10
      &.on .timing::after
        transform: rotate(180deg)
        background-position: center bottom        
      .ball-selection-box
        back-image($ASSETSURL + '/lucky/images/bg_02.png')
        height: calc(100% - .23rem)
        margin-top: -.07rem
        .scroll-box
          height: 100%
          overflow: hidden
        h3
          // height: h = .17rem
          line-height: .17rem
          font-size: .12rem
          font-family: PingFangSC
          color: #fff
          padding: .15rem 5% .1rem 
          text-align: center
        ul
          padding-bottom: .2rem
          &.alternative dd
            font-size: .24rem
            margin: 0 .13rem
          &.alternative li
            padding-bottom: .24rem 
            &.en dd
              font-size: .14rem  
          li
            padding: 0 0 .14rem .46rem
            position: relative
            p  
              width: .33rem
              padding: .08rem .115rem 0 .085rem
              box-sizing: border-box
              height: .58rem
              back-image($ASSETSURL + '/lucky/images/icon_08.png')
              position: absolute
              left: -.03rem
              top: -1px
              font-size: .13rem
              font-family: PingFangSC
              font-weight: bold
              line-height: .18rem
              color:rgba(37,120,210,1)
            &.en P
              padding-top: 0
            // &.en
            //   padding-left: .6rem
            //   p
            //     width: .72rem
            //     font-size: .1rem
            //     background-size: 100% 100% 
            //     left: -.07rem
            //     text-align: center 
            //     padding-top: 0
            //     line-height: .12rem
            //     height: .32rem
            //     span
            //       margin-top: -.02rem
        dl 
          dd
            width: .52rem
            height: h =.52rem
            line-height: h
            text-align: center
            back-image($ASSETSURL + '/lucky/images/icon_07.png')
            box-shadow:0px 2px 2px rgba(50,135,191,0.6)
            float: left
            margin: .05rem
            border-radius: 50% 
            font-size: .27rem
            font-family: "DIN-BOLD"
            font-family: DIN-BOLD
            font-weight: bolder
            color: rgba(193,232,255,1)
            text-shadow: 0px 1px 3px rgba(60,138,214,1) 
            &.cur
              background-image: url($ASSETSURL + '/lucky/images/icon_07s.png')
              color: rgba(227,89,3,1)
              text-shadow: none
    .betting-list
      width: 100%
      height: 100%
      position: fixed
      left: 0
      bottom: 0
      padding-bottom: .56rem
      background:rgba(0,20,43,.5)
      box-sizing: border-box
      z-index: 300
      .betting-list-box
        position: absolute
        width: 100%
        left: 0
        bottom: .56rem
        padding: 0 .16rem
        box-sizing: border-box
        back-image($ASSETSURL + '/lucky/images/bg_05.png')
        animation: bottom-top .5s forwards
        h3
          width: 1.1rem
          height: h =.34rem
          line-height: h
          text-align: center
          back-image($ASSETSURL + '/lucky/images/bg_04.png')
          position: absolute
          top: -.02rem
          left: calc(50% - .55rem)
          font-size: .15rem
          font-family: PingFangSC;
          font-weight: 600
          color:rgba(180,222,255,1)
        .empty
          text-align: right
          height: h = .18rem
          line-height: h
          font-size: .13rem
          font-family: PingFangSC
          font-weight: bold
          color: rgba(223,236,249,1)
          padding: .15rem 0 
        ul
          padding-bottom: .15rem
          li
            padding: .12rem 0
            border-top: 1px solid #91C1ED
            border-bottom: 1px solid #91C1ED
            position: relative
            .delete
              width: .12rem
              height: .12rem
              back-image($ASSETSURL + '/lucky/images/btn_close.png')
              background-size: .12rem;
              position: absolute;
              right: -.1rem;
              top: 0.06rem;
              padding: .1rem;
            .num
              line-height: .21rem
              font-size: .15rem
              font-family: PingFangSC
              color:rgba(24,118,217,1)
              word-wrap: break-word;
              p
                margin-right: .16rem
                font-weight: bold
                display: inline-block
                vertical-align: top
            span
              color: #fff
              margin-right: .15rem
              display: inline-block
            h4
              height: h = .17rem
              line-height: h
              font-size: .12rem
              font-family: PingFangSC
              color: rgba(255,255,255,.6)
              margin: .04rem 0 .12rem
              span
                padding-left: .16rem
                color: rgba(255,255,255,.6)
            .add-reduce
              h5
                height: h = .16rem
                line-height: h
                font-size: .11rem
                font-family:  PingFangSC;
                color: rgba(255,255,255,.6) 
                margin-bottom: .04rem
              span
                display: block
                height: h = .17rem
                line-height: h
                font-size: .12rem
                font-family: PingFangSC
                font-weight: bold
                color: #fff
              .btn
                width: .28rem
                height: .28rem
                back-image($ASSETSURL + '/lucky/images/btn_04.png')
                &.on
                  back-image($ASSETSURL + '/lucky/images/btn_04s.png')
                &.add
                  back-image($ASSETSURL + '/lucky/images/btn_05.png')
                  &.on
                    back-image($ASSETSURL + '/lucky/images/btn_05s.png')
              .number
                width: .71rem
                height: h = .23rem
                line-height: h
                text-align: center
                background: linear-gradient(180deg,rgba(56,140,235,1) 0%,rgba(67,156,232,1) 100%)
                box-shadow: 0px 1px 1px rgba(154,210,255,1)
                border-radius: .05rem
                margin: 0 .05rem 
                font-size: 0
                input
                  width: 100%
                  height: h
                  line-height: h
                  text-align: center
                  font-size: .12rem
                  font-family: PingFangSC
                  font-weight: bold
                  background: none
                  color: #fff 
    .scroll-betting-list
      height: auto
      .scroll-betting-con 
        height: 100%
        overflow: hidden
      &.on
       height: 4.98rem                            
    .betting
      position: fixed
      width: 100%
      left: 0
      bottom: 0
      z-index: 400
      transform: translateY(100%)
      transition: all .5s
      &.en p
        line-height: .14rem !important 
      &.on
        transform: translateY(0)
      .betting-con
        box-sizing: border-box
        position: relative
        z-index: 20
        .betting-box
          height: .64rem
          background: linear-gradient(360deg,rgba(22,107,206,1) 0%,rgba(42,163,234,1) 100%)
          padding:0 .05rem
          width: 100%
          position: relative
          z-index: 50
          text-align: left
          .left
            span
              display: block
              //width: .38rem
              height: h = .26rem
              line-height: h
              text-align: center
              //back-image($ASSETSURL + '/lucky/images/btn_02.png')
              //background-size: 100% 100%
              background: linear-gradient(180deg, #7172F1, #4646CE)
              border: .02rem solid #95C9E3
              box-shadow:0px 2px 2px rgba(13,75,147,0.31)
              border-radius: h
              margin-right: .05rem
              font-size: .11rem
              font-family: PingFangSC
              padding: 0 .1rem
              word-break: break-all
              white-space: nowrap
            h4
              font-size: .14rem
              font-family: PingFangSC
              font-weight: bold
            p
              //height: h = .18rem
              line-height: .18rem
              font-size: .12rem
              font-family: PingFangSC;
              color: rgba(255,255,255,.6)
              padding-bottom:.02rem
            h5
              font-size: .1rem
              font-family: PingFangSC
              color: rgba(165,205,239,1)
          .left
            flex: 1
            //padding-right: .15rem    
          .right
            width: 1.2rem
            height: h = .4rem
            line-height: h
            text-align: center
            back-image($ASSETSURL + '/lucky/images/btn_03.png')
            font-family: Helvetica
            font-weight: bold
            color:rgba(255,255,255,1)
            text-shadow:0px 1px 2px rgba(42,177,42,1)
            font-size: .17rem
          &.on
            background-image: url($ASSETSURL + '/lucky/images/btn_03s.png') 
        .cur-betting
          width: 100%
          height: h =.2rem
          line-height: h
          background: rgba(245,244,225,.95)
          position: absolute
          left:0
          bottom: 100%
          padding-left: .08rem
          box-sizing: border-box
          transition: all .5s
          z-index: 20
          text-align: left
          overflow-x:auto
          -webkit-overflow-scrolling: touch
          overflow-y: hidden
          span
            font-size: .13rem
            font-family: PingFangSC
            font-weight: bold
            color: rgba(227,89,3,1)
            margin-right: .25rem
  .bottom-top-enter, .bottom-top-leave-active
    opcity: 0
    transform: translateY(100%)
  .fadeInOut-leave-active
    opcity: 0
    //transform: translateX(100%)                     
</style>